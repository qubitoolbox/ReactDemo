{"ast":null,"code":"/**\n    * @license\n    * Copyright 2019 Google LLC. All Rights Reserved.\n    * Licensed under the Apache License, Version 2.0 (the \"License\");\n    * you may not use this file except in compliance with the License.\n    * You may obtain a copy of the License at\n    *\n    * http://www.apache.org/licenses/LICENSE-2.0\n    *\n    * Unless required by applicable law or agreed to in writing, software\n    * distributed under the License is distributed on an \"AS IS\" BASIS,\n    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    * See the License for the specific language governing permissions and\n    * limitations under the License.\n    * =============================================================================\n    */\nimport { loadGraphModel } from \"@tensorflow/tfjs-converter\";\nimport { util, tensor2d, tensor1d } from \"@tensorflow/tfjs-core\";\n\nfunction __awaiter(t, e, r, n) {\n  return new (r || (r = Promise))(function (o, i) {\n    function a(t) {\n      try {\n        s(n.next(t));\n      } catch (t) {\n        i(t);\n      }\n    }\n\n    function l(t) {\n      try {\n        s(n.throw(t));\n      } catch (t) {\n        i(t);\n      }\n    }\n\n    function s(t) {\n      t.done ? o(t.value) : new r(function (e) {\n        e(t.value);\n      }).then(a, l);\n    }\n\n    s((n = n.apply(t, e || [])).next());\n  });\n}\n\nfunction __generator(t, e) {\n  var r,\n      n,\n      o,\n      i,\n      a = {\n    label: 0,\n    sent: function () {\n      if (1 & o[0]) throw o[1];\n      return o[1];\n    },\n    trys: [],\n    ops: []\n  };\n  return i = {\n    next: l(0),\n    throw: l(1),\n    return: l(2)\n  }, \"function\" == typeof Symbol && (i[Symbol.iterator] = function () {\n    return this;\n  }), i;\n\n  function l(i) {\n    return function (l) {\n      return function (i) {\n        if (r) throw new TypeError(\"Generator is already executing.\");\n\n        for (; a;) try {\n          if (r = 1, n && (o = 2 & i[0] ? n.return : i[0] ? n.throw || ((o = n.return) && o.call(n), 0) : n.next) && !(o = o.call(n, i[1])).done) return o;\n\n          switch (n = 0, o && (i = [2 & i[0], o.value]), i[0]) {\n            case 0:\n            case 1:\n              o = i;\n              break;\n\n            case 4:\n              return a.label++, {\n                value: i[1],\n                done: !1\n              };\n\n            case 5:\n              a.label++, n = i[1], i = [0];\n              continue;\n\n            case 7:\n              i = a.ops.pop(), a.trys.pop();\n              continue;\n\n            default:\n              if (!(o = (o = a.trys).length > 0 && o[o.length - 1]) && (6 === i[0] || 2 === i[0])) {\n                a = 0;\n                continue;\n              }\n\n              if (3 === i[0] && (!o || i[1] > o[0] && i[1] < o[3])) {\n                a.label = i[1];\n                break;\n              }\n\n              if (6 === i[0] && a.label < o[1]) {\n                a.label = o[1], o = i;\n                break;\n              }\n\n              if (o && a.label < o[2]) {\n                a.label = o[2], a.ops.push(i);\n                break;\n              }\n\n              o[2] && a.ops.pop(), a.trys.pop();\n              continue;\n          }\n\n          i = e.call(t, a);\n        } catch (t) {\n          i = [6, t], n = 0;\n        } finally {\n          r = o = 0;\n        }\n\n        if (5 & i[0]) throw i[1];\n        return {\n          value: i[0] ? i[1] : void 0,\n          done: !0\n        };\n      }([i, l]);\n    };\n  }\n}\n\nfunction __awaiter$1(t, e, r, n) {\n  return new (r || (r = Promise))(function (o, i) {\n    function a(t) {\n      try {\n        s(n.next(t));\n      } catch (t) {\n        i(t);\n      }\n    }\n\n    function l(t) {\n      try {\n        s(n.throw(t));\n      } catch (t) {\n        i(t);\n      }\n    }\n\n    function s(t) {\n      t.done ? o(t.value) : new r(function (e) {\n        e(t.value);\n      }).then(a, l);\n    }\n\n    s((n = n.apply(t, e || [])).next());\n  });\n}\n\nfunction __generator$1(t, e) {\n  var r,\n      n,\n      o,\n      i,\n      a = {\n    label: 0,\n    sent: function () {\n      if (1 & o[0]) throw o[1];\n      return o[1];\n    },\n    trys: [],\n    ops: []\n  };\n  return i = {\n    next: l(0),\n    throw: l(1),\n    return: l(2)\n  }, \"function\" == typeof Symbol && (i[Symbol.iterator] = function () {\n    return this;\n  }), i;\n\n  function l(i) {\n    return function (l) {\n      return function (i) {\n        if (r) throw new TypeError(\"Generator is already executing.\");\n\n        for (; a;) try {\n          if (r = 1, n && (o = 2 & i[0] ? n.return : i[0] ? n.throw || ((o = n.return) && o.call(n), 0) : n.next) && !(o = o.call(n, i[1])).done) return o;\n\n          switch (n = 0, o && (i = [2 & i[0], o.value]), i[0]) {\n            case 0:\n            case 1:\n              o = i;\n              break;\n\n            case 4:\n              return a.label++, {\n                value: i[1],\n                done: !1\n              };\n\n            case 5:\n              a.label++, n = i[1], i = [0];\n              continue;\n\n            case 7:\n              i = a.ops.pop(), a.trys.pop();\n              continue;\n\n            default:\n              if (!(o = (o = a.trys).length > 0 && o[o.length - 1]) && (6 === i[0] || 2 === i[0])) {\n                a = 0;\n                continue;\n              }\n\n              if (3 === i[0] && (!o || i[1] > o[0] && i[1] < o[3])) {\n                a.label = i[1];\n                break;\n              }\n\n              if (6 === i[0] && a.label < o[1]) {\n                a.label = o[1], o = i;\n                break;\n              }\n\n              if (o && a.label < o[2]) {\n                a.label = o[2], a.ops.push(i);\n                break;\n              }\n\n              o[2] && a.ops.pop(), a.trys.pop();\n              continue;\n          }\n\n          i = e.call(t, a);\n        } catch (t) {\n          i = [6, t], n = 0;\n        } finally {\n          r = o = 0;\n        }\n\n        if (5 & i[0]) throw i[1];\n        return {\n          value: i[0] ? i[1] : void 0,\n          done: !0\n        };\n      }([i, l]);\n    };\n  }\n}\n\nvar stringToChars = function (t) {\n  for (var e = [], r = 0, n = t; r < n.length; r++) {\n    var o = n[r];\n    e.push(o);\n  }\n\n  return e;\n},\n    TrieNode = function () {\n  this.parent = null, this.children = {}, this.end = !1, this.word = [[], 0, 0];\n},\n    Trie = function () {\n  function t() {\n    this.root = new TrieNode();\n  }\n\n  return t.prototype.insert = function (t, e, r) {\n    for (var n = this.root, o = stringToChars(t), i = 0; i < o.length; i++) n.children[o[i]] || (n.children[o[i]] = new TrieNode(), n.children[o[i]].parent = n, n.children[o[i]].word[0] = n.word[0].concat(o[i])), n = n.children[o[i]], i === o.length - 1 && (n.end = !0, n.word[1] = e, n.word[2] = r);\n  }, t.prototype.commonPrefixSearch = function (t) {\n    for (var e = [], r = this.root.children[t[0]], n = 0; n < t.length && r; n++) r.end && e.push(r.word), r = r.children[t[n + 1]];\n\n    return e.length || e.push([[t[0]], 0, 0]), e;\n  }, t;\n}(),\n    separator = \"▁\";\n\nfunction processInput(t) {\n  var e = t.normalize(\"NFKC\");\n  return separator + e.replace(/ /g, separator);\n}\n\nvar RESERVED_SYMBOLS_COUNT = 6,\n    Tokenizer = function () {\n  function t(t) {\n    this.vocabulary = t, this.trie = new Trie();\n\n    for (var e = RESERVED_SYMBOLS_COUNT; e < this.vocabulary.length; e++) this.trie.insert(this.vocabulary[e][0], this.vocabulary[e][1], e);\n  }\n\n  return t.prototype.encode = function (t) {\n    var e = [],\n        r = [],\n        n = [];\n    t = processInput(t);\n\n    for (var o = stringToChars(t), i = 0; i <= o.length; i++) e.push({}), r.push(0), n.push(0);\n\n    for (i = 0; i < o.length; i++) for (var a = this.trie.commonPrefixSearch(o.slice(i)), l = 0; l < a.length; l++) {\n      var s = a[l],\n          u = {\n        key: s[0],\n        score: s[1],\n        index: s[2]\n      };\n      null == e[i + (c = s[0].length)][i] && (e[i + c][i] = []), e[i + c][i].push(u);\n    }\n\n    for (var c = 0; c <= o.length; c++) for (var h in e[c]) {\n      var f = e[c][h];\n\n      for (l = 0; l < f.length; l++) {\n        var d = f[l],\n            p = d.score + n[c - d.key.length];\n        (0 === n[c] || p >= n[c]) && (n[c] = p, r[c] = f[l].index);\n      }\n    }\n\n    for (var v = [], y = r.length - 1; y > 0;) v.push(r[y]), y -= this.vocabulary[r[y]][0].length;\n\n    var b = [],\n        w = !1;\n\n    for (i = 0; i < v.length; i++) {\n      var g = v[i];\n      w && 0 === g || b.push(g), w = 0 === g;\n    }\n\n    return b.reverse();\n  }, t;\n}(),\n    BASE_PATH = \"https://storage.googleapis.com/tfjs-models/savedmodel/universal_sentence_encoder/\";\n\nfunction loadTokenizer(t) {\n  return __awaiter$1(this, void 0, void 0, function () {\n    var e;\n    return __generator$1(this, function (r) {\n      switch (r.label) {\n        case 0:\n          return [4, loadVocabulary(t)];\n\n        case 1:\n          return e = r.sent(), [2, new Tokenizer(e)];\n      }\n    });\n  });\n}\n\nfunction loadVocabulary(t) {\n  return void 0 === t && (t = BASE_PATH + \"vocab.json\"), __awaiter$1(this, void 0, void 0, function () {\n    return __generator$1(this, function (e) {\n      switch (e.label) {\n        case 0:\n          return [4, util.fetch(t)];\n\n        case 1:\n          return [2, e.sent().json()];\n      }\n    });\n  });\n}\n\nvar version$1 = \"1.2.2\";\n\nfunction load$1(t, e) {\n  return __awaiter(this, void 0, void 0, function () {\n    var r;\n    return __generator(this, function (n) {\n      switch (n.label) {\n        case 0:\n          return [4, (r = new ToxicityClassifier(t, e)).load()];\n\n        case 1:\n          return n.sent(), [2, r];\n      }\n    });\n  });\n}\n\nvar ToxicityClassifier = function () {\n  function t(t, e) {\n    void 0 === t && (t = .85), void 0 === e && (e = []), this.threshold = t, this.toxicityLabels = e;\n  }\n\n  return t.prototype.loadModel = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (t) {\n        return [2, loadGraphModel(\"https://tfhub.dev/tensorflow/tfjs-model/toxicity/1/default/1\", {\n          fromTFHub: !0\n        })];\n      });\n    });\n  }, t.prototype.loadTokenizer = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (t) {\n        return [2, loadTokenizer()];\n      });\n    });\n  }, t.prototype.load = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t,\n          e,\n          r,\n          n = this;\n      return __generator(this, function (o) {\n        switch (o.label) {\n          case 0:\n            return [4, Promise.all([this.loadModel(), this.loadTokenizer()])];\n\n          case 1:\n            return t = o.sent(), e = t[0], r = t[1], this.model = e, this.tokenizer = r, this.labels = e.outputs.map(function (t) {\n              return t.name.split(\"/\")[0];\n            }), 0 === this.toxicityLabels.length ? this.toxicityLabels = this.labels : util.assert(this.toxicityLabels.every(function (t) {\n              return n.labels.indexOf(t) > -1;\n            }), function () {\n              return \"toxicityLabels argument must contain only items from the model heads \" + n.labels.join(\", \") + \", got \" + n.toxicityLabels.join(\", \");\n            }), [2];\n        }\n      });\n    });\n  }, t.prototype.classify = function (t) {\n    return __awaiter(this, void 0, void 0, function () {\n      var e,\n          r,\n          n,\n          o,\n          i,\n          a,\n          l,\n          s = this;\n      return __generator(this, function (u) {\n        switch (u.label) {\n          case 0:\n            for (\"string\" == typeof t && (t = [t]), e = t.map(function (t) {\n              return s.tokenizer.encode(t);\n            }), r = e.map(function (t, e) {\n              return t.map(function (t, r) {\n                return [e, r];\n              });\n            }), n = [], o = 0; o < r.length; o++) n = n.concat(r[o]);\n\n            return i = tensor2d(n, [n.length, 2], \"int32\"), a = tensor1d(util.flatten(e), \"int32\"), [4, this.model.executeAsync({\n              Placeholder_1: i,\n              Placeholder: a\n            })];\n\n          case 1:\n            return l = u.sent(), i.dispose(), a.dispose(), [2, l.map(function (t, e) {\n              return {\n                data: t,\n                headIndex: e\n              };\n            }).filter(function (t) {\n              return s.toxicityLabels.indexOf(s.labels[t.headIndex]) > -1;\n            }).map(function (e) {\n              for (var r = e.data.dataSync(), n = [], o = 0; o < t.length; o++) {\n                var i = r.slice(2 * o, 2 * o + 2),\n                    a = null;\n                Math.max(i[0], i[1]) > s.threshold && (a = i[0] < i[1]), n.push({\n                  probabilities: i,\n                  match: a\n                });\n              }\n\n              return {\n                label: s.labels[e.headIndex],\n                results: n\n              };\n            })];\n        }\n      });\n    });\n  }, t;\n}();\n\nexport { load$1 as load, ToxicityClassifier, version$1 as version };","map":{"version":3,"sources":["C:/NewReactResume/resm/node_modules/@tensorflow-models/toxicity/dist/toxicity.esm.js"],"names":["loadGraphModel","util","tensor2d","tensor1d","__awaiter","t","e","r","n","Promise","o","i","a","s","next","l","throw","done","value","then","apply","__generator","label","sent","trys","ops","return","Symbol","iterator","TypeError","call","pop","length","push","__awaiter$1","__generator$1","stringToChars","TrieNode","parent","children","end","word","Trie","root","prototype","insert","concat","commonPrefixSearch","separator","processInput","normalize","replace","RESERVED_SYMBOLS_COUNT","Tokenizer","vocabulary","trie","encode","slice","u","key","score","index","c","h","f","d","p","v","y","b","w","g","reverse","BASE_PATH","loadTokenizer","loadVocabulary","fetch","json","version$1","load$1","ToxicityClassifier","load","threshold","toxicityLabels","loadModel","fromTFHub","all","model","tokenizer","labels","outputs","map","name","split","assert","every","indexOf","join","classify","flatten","executeAsync","Placeholder_1","Placeholder","dispose","data","headIndex","filter","dataSync","Math","max","probabilities","match","results","version"],"mappings":"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","sourcesContent":["/**\n    * @license\n    * Copyright 2019 Google LLC. All Rights Reserved.\n    * Licensed under the Apache License, Version 2.0 (the \"License\");\n    * you may not use this file except in compliance with the License.\n    * You may obtain a copy of the License at\n    *\n    * http://www.apache.org/licenses/LICENSE-2.0\n    *\n    * Unless required by applicable law or agreed to in writing, software\n    * distributed under the License is distributed on an \"AS IS\" BASIS,\n    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    * See the License for the specific language governing permissions and\n    * limitations under the License.\n    * =============================================================================\n    */\nimport{loadGraphModel}from\"@tensorflow/tfjs-converter\";import{util,tensor2d,tensor1d}from\"@tensorflow/tfjs-core\";function __awaiter(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function l(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,l)}s((n=n.apply(t,e||[])).next())})}function __generator(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},\"function\"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(r)throw new TypeError(\"Generator is already executing.\");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}function __awaiter$1(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function l(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,l)}s((n=n.apply(t,e||[])).next())})}function __generator$1(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},\"function\"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(r)throw new TypeError(\"Generator is already executing.\");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}var stringToChars=function(t){for(var e=[],r=0,n=t;r<n.length;r++){var o=n[r];e.push(o)}return e},TrieNode=function(){this.parent=null,this.children={},this.end=!1,this.word=[[],0,0]},Trie=function(){function t(){this.root=new TrieNode}return t.prototype.insert=function(t,e,r){for(var n=this.root,o=stringToChars(t),i=0;i<o.length;i++)n.children[o[i]]||(n.children[o[i]]=new TrieNode,n.children[o[i]].parent=n,n.children[o[i]].word[0]=n.word[0].concat(o[i])),n=n.children[o[i]],i===o.length-1&&(n.end=!0,n.word[1]=e,n.word[2]=r)},t.prototype.commonPrefixSearch=function(t){for(var e=[],r=this.root.children[t[0]],n=0;n<t.length&&r;n++)r.end&&e.push(r.word),r=r.children[t[n+1]];return e.length||e.push([[t[0]],0,0]),e},t}(),separator=\"▁\";function processInput(t){var e=t.normalize(\"NFKC\");return separator+e.replace(/ /g,separator)}var RESERVED_SYMBOLS_COUNT=6,Tokenizer=function(){function t(t){this.vocabulary=t,this.trie=new Trie;for(var e=RESERVED_SYMBOLS_COUNT;e<this.vocabulary.length;e++)this.trie.insert(this.vocabulary[e][0],this.vocabulary[e][1],e)}return t.prototype.encode=function(t){var e=[],r=[],n=[];t=processInput(t);for(var o=stringToChars(t),i=0;i<=o.length;i++)e.push({}),r.push(0),n.push(0);for(i=0;i<o.length;i++)for(var a=this.trie.commonPrefixSearch(o.slice(i)),l=0;l<a.length;l++){var s=a[l],u={key:s[0],score:s[1],index:s[2]};null==e[i+(c=s[0].length)][i]&&(e[i+c][i]=[]),e[i+c][i].push(u)}for(var c=0;c<=o.length;c++)for(var h in e[c]){var f=e[c][h];for(l=0;l<f.length;l++){var d=f[l],p=d.score+n[c-d.key.length];(0===n[c]||p>=n[c])&&(n[c]=p,r[c]=f[l].index)}}for(var v=[],y=r.length-1;y>0;)v.push(r[y]),y-=this.vocabulary[r[y]][0].length;var b=[],w=!1;for(i=0;i<v.length;i++){var g=v[i];w&&0===g||b.push(g),w=0===g}return b.reverse()},t}(),BASE_PATH=\"https://storage.googleapis.com/tfjs-models/savedmodel/universal_sentence_encoder/\";function loadTokenizer(t){return __awaiter$1(this,void 0,void 0,function(){var e;return __generator$1(this,function(r){switch(r.label){case 0:return[4,loadVocabulary(t)];case 1:return e=r.sent(),[2,new Tokenizer(e)]}})})}function loadVocabulary(t){return void 0===t&&(t=BASE_PATH+\"vocab.json\"),__awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(e){switch(e.label){case 0:return[4,util.fetch(t)];case 1:return[2,e.sent().json()]}})})}var version$1=\"1.2.2\";function load$1(t,e){return __awaiter(this,void 0,void 0,function(){var r;return __generator(this,function(n){switch(n.label){case 0:return[4,(r=new ToxicityClassifier(t,e)).load()];case 1:return n.sent(),[2,r]}})})}var ToxicityClassifier=function(){function t(t,e){void 0===t&&(t=.85),void 0===e&&(e=[]),this.threshold=t,this.toxicityLabels=e}return t.prototype.loadModel=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,loadGraphModel(\"https://tfhub.dev/tensorflow/tfjs-model/toxicity/1/default/1\",{fromTFHub:!0})]})})},t.prototype.loadTokenizer=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,loadTokenizer()]})})},t.prototype.load=function(){return __awaiter(this,void 0,void 0,function(){var t,e,r,n=this;return __generator(this,function(o){switch(o.label){case 0:return[4,Promise.all([this.loadModel(),this.loadTokenizer()])];case 1:return t=o.sent(),e=t[0],r=t[1],this.model=e,this.tokenizer=r,this.labels=e.outputs.map(function(t){return t.name.split(\"/\")[0]}),0===this.toxicityLabels.length?this.toxicityLabels=this.labels:util.assert(this.toxicityLabels.every(function(t){return n.labels.indexOf(t)>-1}),function(){return\"toxicityLabels argument must contain only items from the model heads \"+n.labels.join(\", \")+\", got \"+n.toxicityLabels.join(\", \")}),[2]}})})},t.prototype.classify=function(t){return __awaiter(this,void 0,void 0,function(){var e,r,n,o,i,a,l,s=this;return __generator(this,function(u){switch(u.label){case 0:for(\"string\"==typeof t&&(t=[t]),e=t.map(function(t){return s.tokenizer.encode(t)}),r=e.map(function(t,e){return t.map(function(t,r){return[e,r]})}),n=[],o=0;o<r.length;o++)n=n.concat(r[o]);return i=tensor2d(n,[n.length,2],\"int32\"),a=tensor1d(util.flatten(e),\"int32\"),[4,this.model.executeAsync({Placeholder_1:i,Placeholder:a})];case 1:return l=u.sent(),i.dispose(),a.dispose(),[2,l.map(function(t,e){return{data:t,headIndex:e}}).filter(function(t){return s.toxicityLabels.indexOf(s.labels[t.headIndex])>-1}).map(function(e){for(var r=e.data.dataSync(),n=[],o=0;o<t.length;o++){var i=r.slice(2*o,2*o+2),a=null;Math.max(i[0],i[1])>s.threshold&&(a=i[0]<i[1]),n.push({probabilities:i,match:a})}return{label:s.labels[e.headIndex],results:n}})]}})})},t}();export{load$1 as load,ToxicityClassifier,version$1 as version};\n"]},"metadata":{},"sourceType":"module"}