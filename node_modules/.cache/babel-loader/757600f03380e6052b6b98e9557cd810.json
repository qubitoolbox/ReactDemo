{"ast":null,"code":"import { stableCompare, Transform } from 'vega-dataflow';\nimport { error, inherits, one } from 'vega-util';\n/**\n * Abstract class for tree layout.\n * @constructor\n * @param {object} params - The parameters for this operator.\n */\n\nexport default function HierarchyLayout(params) {\n  Transform.call(this, null, params);\n}\nvar prototype = inherits(HierarchyLayout, Transform);\n\nprototype.transform = function (_, pulse) {\n  if (!pulse.source || !pulse.source.root) {\n    error(this.constructor.name + ' transform requires a backing tree data source.');\n  }\n\n  var layout = this.layout(_.method),\n      fields = this.fields,\n      root = pulse.source.root,\n      as = _.as || fields;\n  if (_.field) root.sum(_.field);else root.count();\n  if (_.sort) root.sort(stableCompare(_.sort, d => d.data));\n  setParams(layout, this.params, _);\n\n  if (layout.separation) {\n    layout.separation(_.separation !== false ? defaultSeparation : one);\n  }\n\n  try {\n    this.value = layout(root);\n  } catch (err) {\n    error(err);\n  }\n\n  root.each(function (node) {\n    setFields(node, fields, as);\n  });\n  return pulse.reflow(_.modified()).modifies(as).modifies('leaf');\n};\n\nfunction setParams(layout, params, _) {\n  for (var p, i = 0, n = params.length; i < n; ++i) {\n    p = params[i];\n    if (p in _) layout[p](_[p]);\n  }\n}\n\nfunction setFields(node, fields, as) {\n  var t = node.data;\n\n  for (var i = 0, n = fields.length - 1; i < n; ++i) {\n    t[as[i]] = node[fields[i]];\n  }\n\n  t[as[n]] = node.children ? node.children.length : 0;\n}\n\nfunction defaultSeparation(a, b) {\n  return a.parent === b.parent ? 1 : 2;\n}","map":{"version":3,"sources":["C:/NewReactResume/resm/node_modules/vega-hierarchy/src/HierarchyLayout.js"],"names":["stableCompare","Transform","error","inherits","one","HierarchyLayout","params","call","prototype","transform","_","pulse","source","root","constructor","name","layout","method","fields","as","field","sum","count","sort","d","data","setParams","separation","defaultSeparation","value","err","each","node","setFields","reflow","modified","modifies","p","i","n","length","t","children","a","b","parent"],"mappings":"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","sourcesContent":["import {stableCompare, Transform} from 'vega-dataflow';\nimport {error, inherits, one} from 'vega-util';\n\n/**\n * Abstract class for tree layout.\n * @constructor\n * @param {object} params - The parameters for this operator.\n */\nexport default function HierarchyLayout(params) {\n  Transform.call(this, null, params);\n}\n\nvar prototype = inherits(HierarchyLayout, Transform);\n\nprototype.transform = function(_, pulse) {\n  if (!pulse.source || !pulse.source.root) {\n    error(this.constructor.name\n      + ' transform requires a backing tree data source.');\n  }\n\n  var layout = this.layout(_.method),\n      fields = this.fields,\n      root = pulse.source.root,\n      as = _.as || fields;\n\n  if (_.field) root.sum(_.field); else root.count();\n  if (_.sort) root.sort(stableCompare(_.sort, d => d.data));\n\n  setParams(layout, this.params, _);\n  if (layout.separation) {\n    layout.separation(_.separation !== false ? defaultSeparation : one);\n  }\n\n  try {\n    this.value = layout(root);\n  } catch (err) {\n    error(err);\n  }\n  root.each(function(node) { setFields(node, fields, as); });\n\n  return pulse.reflow(_.modified()).modifies(as).modifies('leaf');\n};\n\nfunction setParams(layout, params, _) {\n  for (var p, i=0, n=params.length; i<n; ++i) {\n    p = params[i];\n    if (p in _) layout[p](_[p]);\n  }\n}\n\nfunction setFields(node, fields, as) {\n  var t = node.data;\n  for (var i=0, n=fields.length-1; i<n; ++i) {\n    t[as[i]] = node[fields[i]];\n  }\n  t[as[n]] = node.children ? node.children.length : 0;\n}\n\nfunction defaultSeparation(a, b) {\n  return a.parent === b.parent ? 1 : 2;\n}\n"]},"metadata":{},"sourceType":"module"}