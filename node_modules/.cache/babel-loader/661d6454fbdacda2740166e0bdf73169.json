{"ast":null,"code":"var __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport { isArray, isObject, isString } from 'vega-util';\n/**\n * Format the value to be shown in the toolip.\n *\n * @param value The value to show in the tooltip.\n * @param valueToHtml Function to convert a single cell value to an HTML string\n */\n\nexport function formatValue(value, valueToHtml, maxDepth) {\n  if (isArray(value)) {\n    return `[${value.map(v => valueToHtml(isString(v) ? v : stringify(v, maxDepth))).join(', ')}]`;\n  }\n\n  if (isObject(value)) {\n    let content = '';\n\n    const _a = value,\n          {\n      title\n    } = _a,\n          rest = __rest(_a, [\"title\"]);\n\n    if (title) {\n      content += `<h2>${valueToHtml(title)}</h2>`;\n    }\n\n    const keys = Object.keys(rest);\n\n    if (keys.length > 0) {\n      content += '<table>';\n\n      for (const key of keys) {\n        let val = rest[key]; // ignore undefined properties\n\n        if (val === undefined) {\n          continue;\n        }\n\n        if (isObject(val)) {\n          val = stringify(val, maxDepth);\n        }\n\n        content += `<tr><td class=\"key\">${valueToHtml(key)}:</td><td class=\"value\">${valueToHtml(val)}</td></tr>`;\n      }\n\n      content += `</table>`;\n    }\n\n    return content || '{}'; // show empty object if there are no properties\n  }\n\n  return valueToHtml(value);\n}\nexport function replacer(maxDepth) {\n  const stack = [];\n  return function (key, value) {\n    if (typeof value !== 'object' || value === null) {\n      return value;\n    }\n\n    const pos = stack.indexOf(this) + 1;\n    stack.length = pos;\n\n    if (stack.length > maxDepth) {\n      return '[Object]';\n    }\n\n    if (stack.indexOf(value) >= 0) {\n      return '[Circular]';\n    }\n\n    stack.push(value);\n    return value;\n  };\n}\n/**\n * Stringify any JS object to valid JSON\n */\n\nexport function stringify(obj, maxDepth) {\n  return JSON.stringify(obj, replacer(maxDepth));\n}","map":{"version":3,"sources":["../../src/formatValue.ts"],"names":[],"mappings":";;;;;;;;;;;AAAA,SAAQ,OAAR,EAAiB,QAAjB,EAA2B,QAA3B,QAA0C,WAA1C;AAEA;;;;;;;AAMA,OAAM,SAAU,WAAV,CAAsB,KAAtB,EAAkC,WAAlC,EAAuE,QAAvE,EAAuF;AAC3F,MAAI,OAAO,CAAC,KAAD,CAAX,EAAoB;AAClB,WAAO,IAAI,KAAK,CAAC,GAAN,CAAU,CAAC,IAAI,WAAW,CAAC,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAd,GAAkB,SAAS,CAAC,CAAD,EAAI,QAAJ,CAA5B,CAA1B,EAAsE,IAAtE,CAA2E,IAA3E,CAAgF,GAA3F;AACD;;AAED,MAAI,QAAQ,CAAC,KAAD,CAAZ,EAAqB;AACnB,QAAI,OAAO,GAAG,EAAd;;AAEA,UAAM,EAAA,GAAA,KAAN;AAAA,UAAM;AAAC,MAAA;AAAD,QAAM,EAAZ;AAAA,UAAc,IAAA,GAAA,MAAA,CAAA,EAAA,EAAA,CAAA,OAAA,CAAA,CAAd;;AAEA,QAAI,KAAJ,EAAW;AACT,MAAA,OAAO,IAAI,OAAO,WAAW,CAAC,KAAD,CAAO,OAApC;AACD;;AAED,UAAM,IAAI,GAAG,MAAM,CAAC,IAAP,CAAY,IAAZ,CAAb;;AACA,QAAI,IAAI,CAAC,MAAL,GAAc,CAAlB,EAAqB;AACnB,MAAA,OAAO,IAAI,SAAX;;AACA,WAAK,MAAM,GAAX,IAAkB,IAAlB,EAAwB;AACtB,YAAI,GAAG,GAAI,IAAY,CAAC,GAAD,CAAvB,CADsB,CAGtB;;AACA,YAAI,GAAG,KAAK,SAAZ,EAAuB;AACrB;AACD;;AAED,YAAI,QAAQ,CAAC,GAAD,CAAZ,EAAmB;AACjB,UAAA,GAAG,GAAG,SAAS,CAAC,GAAD,EAAM,QAAN,CAAf;AACD;;AAED,QAAA,OAAO,IAAI,uBAAuB,WAAW,CAAC,GAAD,CAAK,2BAA2B,WAAW,CAAC,GAAD,CAAK,YAA7F;AACD;;AACD,MAAA,OAAO,IAAI,UAAX;AACD;;AAED,WAAO,OAAO,IAAI,IAAlB,CA7BmB,CA6BK;AACzB;;AAED,SAAO,WAAW,CAAC,KAAD,CAAlB;AACD;AAED,OAAM,SAAU,QAAV,CAAmB,QAAnB,EAAmC;AACvC,QAAM,KAAK,GAAU,EAArB;AAEA,SAAO,UAAoB,GAApB,EAAiC,KAAjC,EAA2C;AAChD,QAAI,OAAO,KAAP,KAAiB,QAAjB,IAA6B,KAAK,KAAK,IAA3C,EAAiD;AAC/C,aAAO,KAAP;AACD;;AACD,UAAM,GAAG,GAAG,KAAK,CAAC,OAAN,CAAc,IAAd,IAAsB,CAAlC;AACA,IAAA,KAAK,CAAC,MAAN,GAAe,GAAf;;AACA,QAAI,KAAK,CAAC,MAAN,GAAe,QAAnB,EAA6B;AAC3B,aAAO,UAAP;AACD;;AACD,QAAI,KAAK,CAAC,OAAN,CAAc,KAAd,KAAwB,CAA5B,EAA+B;AAC7B,aAAO,YAAP;AACD;;AACD,IAAA,KAAK,CAAC,IAAN,CAAW,KAAX;AACA,WAAO,KAAP;AACD,GAdD;AAeD;AAED;;;;AAGA,OAAM,SAAU,SAAV,CAAoB,GAApB,EAA8B,QAA9B,EAA8C;AAClD,SAAO,IAAI,CAAC,SAAL,CAAe,GAAf,EAAoB,QAAQ,CAAC,QAAD,CAA5B,CAAP;AACD","sourceRoot":"","sourcesContent":["var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { isArray, isObject, isString } from 'vega-util';\n/**\n * Format the value to be shown in the toolip.\n *\n * @param value The value to show in the tooltip.\n * @param valueToHtml Function to convert a single cell value to an HTML string\n */\nexport function formatValue(value, valueToHtml, maxDepth) {\n    if (isArray(value)) {\n        return `[${value.map(v => valueToHtml(isString(v) ? v : stringify(v, maxDepth))).join(', ')}]`;\n    }\n    if (isObject(value)) {\n        let content = '';\n        const _a = value, { title } = _a, rest = __rest(_a, [\"title\"]);\n        if (title) {\n            content += `<h2>${valueToHtml(title)}</h2>`;\n        }\n        const keys = Object.keys(rest);\n        if (keys.length > 0) {\n            content += '<table>';\n            for (const key of keys) {\n                let val = rest[key];\n                // ignore undefined properties\n                if (val === undefined) {\n                    continue;\n                }\n                if (isObject(val)) {\n                    val = stringify(val, maxDepth);\n                }\n                content += `<tr><td class=\"key\">${valueToHtml(key)}:</td><td class=\"value\">${valueToHtml(val)}</td></tr>`;\n            }\n            content += `</table>`;\n        }\n        return content || '{}'; // show empty object if there are no properties\n    }\n    return valueToHtml(value);\n}\nexport function replacer(maxDepth) {\n    const stack = [];\n    return function (key, value) {\n        if (typeof value !== 'object' || value === null) {\n            return value;\n        }\n        const pos = stack.indexOf(this) + 1;\n        stack.length = pos;\n        if (stack.length > maxDepth) {\n            return '[Object]';\n        }\n        if (stack.indexOf(value) >= 0) {\n            return '[Circular]';\n        }\n        stack.push(value);\n        return value;\n    };\n}\n/**\n * Stringify any JS object to valid JSON\n */\nexport function stringify(obj, maxDepth) {\n    return JSON.stringify(obj, replacer(maxDepth));\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybWF0VmFsdWUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvZm9ybWF0VmFsdWUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQSxPQUFPLEVBQUMsT0FBTyxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFFdEQ7Ozs7O0dBS0c7QUFDSCxNQUFNLFVBQVUsV0FBVyxDQUFDLEtBQVUsRUFBRSxXQUFtQyxFQUFFLFFBQWdCO0lBQzNGLElBQUksT0FBTyxDQUFDLEtBQUssQ0FBQyxFQUFFO1FBQ2xCLE9BQU8sSUFBSSxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQztLQUNoRztJQUVELElBQUksUUFBUSxDQUFDLEtBQUssQ0FBQyxFQUFFO1FBQ25CLElBQUksT0FBTyxHQUFHLEVBQUUsQ0FBQztRQUVqQixNQUFNLFVBQStCLEVBQS9CLEVBQUMsS0FBSyxPQUF5QixFQUF2Qiw0QkFBdUIsQ0FBQztRQUV0QyxJQUFJLEtBQUssRUFBRTtZQUNULE9BQU8sSUFBSSxPQUFPLFdBQVcsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDO1NBQzdDO1FBRUQsTUFBTSxJQUFJLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMvQixJQUFJLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO1lBQ25CLE9BQU8sSUFBSSxTQUFTLENBQUM7WUFDckIsS0FBSyxNQUFNLEdBQUcsSUFBSSxJQUFJLEVBQUU7Z0JBQ3RCLElBQUksR0FBRyxHQUFJLElBQVksQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFFN0IsOEJBQThCO2dCQUM5QixJQUFJLEdBQUcsS0FBSyxTQUFTLEVBQUU7b0JBQ3JCLFNBQVM7aUJBQ1Y7Z0JBRUQsSUFBSSxRQUFRLENBQUMsR0FBRyxDQUFDLEVBQUU7b0JBQ2pCLEdBQUcsR0FBRyxTQUFTLENBQUMsR0FBRyxFQUFFLFFBQVEsQ0FBQyxDQUFDO2lCQUNoQztnQkFFRCxPQUFPLElBQUksdUJBQXVCLFdBQVcsQ0FBQyxHQUFHLENBQUMsMkJBQTJCLFdBQVcsQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDO2FBQzNHO1lBQ0QsT0FBTyxJQUFJLFVBQVUsQ0FBQztTQUN2QjtRQUVELE9BQU8sT0FBTyxJQUFJLElBQUksQ0FBQyxDQUFDLCtDQUErQztLQUN4RTtJQUVELE9BQU8sV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQzVCLENBQUM7QUFFRCxNQUFNLFVBQVUsUUFBUSxDQUFDLFFBQWdCO0lBQ3ZDLE1BQU0sS0FBSyxHQUFVLEVBQUUsQ0FBQztJQUV4QixPQUFPLFVBQW9CLEdBQVcsRUFBRSxLQUFVO1FBQ2hELElBQUksT0FBTyxLQUFLLEtBQUssUUFBUSxJQUFJLEtBQUssS0FBSyxJQUFJLEVBQUU7WUFDL0MsT0FBTyxLQUFLLENBQUM7U0FDZDtRQUNELE1BQU0sR0FBRyxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3BDLEtBQUssQ0FBQyxNQUFNLEdBQUcsR0FBRyxDQUFDO1FBQ25CLElBQUksS0FBSyxDQUFDLE1BQU0sR0FBRyxRQUFRLEVBQUU7WUFDM0IsT0FBTyxVQUFVLENBQUM7U0FDbkI7UUFDRCxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFFO1lBQzdCLE9BQU8sWUFBWSxDQUFDO1NBQ3JCO1FBQ0QsS0FBSyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNsQixPQUFPLEtBQUssQ0FBQztJQUNmLENBQUMsQ0FBQztBQUNKLENBQUM7QUFFRDs7R0FFRztBQUNILE1BQU0sVUFBVSxTQUFTLENBQUMsR0FBUSxFQUFFLFFBQWdCO0lBQ2xELE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7QUFDakQsQ0FBQyJ9"]},"metadata":{},"sourceType":"module"}